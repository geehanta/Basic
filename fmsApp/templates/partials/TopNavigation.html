{% load static %}
<head>
    <style>
        /* Semi-transparent dark background */
        .offcanvas-start {
          background-color: rgba(100, 96, 96, 0.582); /* black with 85% opacity */
          color: white;
        }
      
        /* Navbar links in the sidebar */
        .offcanvas .nav-link {
          color: #f0f0f0; /* light grey */
          transition: background-color 0.3s, color 0.3s;
          padding: 10px 15px;
          border-radius: 5px;
        }
      
        .offcanvas .nav-link:hover {
          background-color: teal;
          color: white;
        }
      
        /* Avatar alignment */
        .offcanvas .nav-link img {
          width: 30px;
          height: 30px;
          object-fit: cover;
        }
      
        .offcanvas .nav-item {
          margin-bottom: 10px;
        }
      
        /* Optional: make links slightly larger for easier mobile tapping */
        .offcanvas .nav-link {
          font-size: 1.05rem;
        }
      </style>
      
</head>
<header>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-teal fixed-top shadow" style="background-color: teal;">
      <div class="container">
        <!-- Brand -->
        <a class="navbar-brand d-flex align-items-center" href="{% url 'home' %}">
          <img src="{{ MEDIA_URL }}/default/microscope.svg" height="20" alt="Logo" class="me-2" loading="lazy">
          <span class="text-light fw-bold">BSL</span>
        </a>
  
        <!-- Toggler for offcanvas sidebar -->
        <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasSidebar" aria-controls="offcanvasSidebar">
          <span class="navbar-toggler-icon"></span>
        </button>
  
        <!-- Main nav (hidden on small screens) -->
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav me-auto" id="topNav">
            <!-- Add more nav links here -->
          </ul>
  
          <!-- Desktop Login/Logout -->
          <ul class="navbar-nav d-none d-lg-flex align-items-center">
            {% if user.id %}
              <li class="nav-item me-3">
                <a class="nav-link text-light d-flex align-items-center" href="{% url 'profile' %}">
                  {% if user.is_authenticated %}
                     <!-- {% if user.profile.profile_image and user.profile.profile_image.url %}
                      <img src="{{ user.profile.profile_image.url }}" 
                          alt="{{ user.first_name }}'s Avatar"
                          class="rounded-circle me-2"
                          style="width: 30px; height: 30px; object-fit: cover;">
                    {% else %}
                      <img src="{{ MEDIA_URL }}profile_pics/useravatar.jpg" 
                          alt="Default Avatar"
                          class="rounded-circle me-2"
                          style="width: 30px; height: 30px; object-fit: cover;">
                    {% endif %}  -->

                      <!-- Greeting text updated dynamically -->
                      <span id="greeting-text" class="ms-1"></span>

                      <script>
                        document.addEventListener("DOMContentLoaded", function() {
                            const hours = new Date().getHours();
                            let greeting;

                            if (hours < 12) {
                                greeting = "ðŸŒž Good Morning";
                            } else if (hours < 18) {
                                greeting = "ðŸŒž Good Afternoon";
                            } else {
                                greeting = "ðŸŒ™ Good Evening";
                            }

                            const username = "{{ user.first_name|default:user.username }}";
                            document.getElementById("greeting-text").textContent = `${greeting}, ${username}`;
                        });
                      </script>

                  {% else %}
                      <img src="{{ MEDIA_URL }}profile_pics/useravatar.jpg" 
                          alt="Default Avatar" 
                          class="rounded-circle me-2" 
                          style="width: 30px; height: 30px; object-fit: cover;">
                      <span class="ms-1">Welcome, Guest</span>
                  {% endif %}
                </a>
              </li>

              <li class="nav-item me-3">
                <a class="nav-link text-light" href="{% url 'logout' %}">Logout</a>
              </li>
            {% else %}
              <li class="nav-item me-3">
                <a class="nav-link text-light" href="{% url 'login' %}">Login</a>
              </li>
              <li class="nav-item me-3">
                <a class="nav-link text-light" href="{% url 'register-user' %}">Signup</a>
              </li>
            {% endif %}
          </ul>
        </div>
      </div>
    </nav>
  
    <!-- Offcanvas Sidebar for Small Screens -->
    <div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasSidebar" aria-labelledby="offcanvasSidebarLabel">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="offcanvasSidebarLabel">Menu</h5>
        <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
      </div>
      <div class="offcanvas-body">
        <ul class="navbar-nav">
          {% if user.id %}
            <li class="nav-item mb-3">
              <a class="nav-link d-flex align-items-center" href="{% url 'profile' %}">
                <img src="{{ MEDIA_URL }}/profile_pics/useravatar." alt="User Avatar" class="rounded-circle me-2" style="width: 30px; height: 30px;">
                Welcome, {{ user.first_name }} {{ user.last_name }}
              </a>
            </li>
            <li class="nav-item mb-2">
              <a class="nav-link" href="{% url 'logout' %}">Logout</a>
            </li>
          {% else %}
            <li class="nav-item mb-2">
              <a class="nav-link" href="{% url 'login' %}">Login</a>
            </li>
            <li class="nav-item mb-2">
              <a class="nav-link" href="{% url 'register-user' %}">Signup</a>
            </li>
          {% endif %}
        </ul>
      </div>
    </div>
  </header>
  
  